{"version":3,"sources":["functions.js","components/Tag.js","components/App.js","components/pages/welcome.js","components/router.js","index.js"],"names":["luma","color","rgb","startsWith","substring","length","charAt","Error","i","parseInt","substr","hexToRGBArray","module","exports","getContrastingColorFromHex","string2color","str","hash","charCodeAt","toString","Tag","tag","style","props","textColor","backgroundColor","pushReplaceSearchParams","new_searchParams","url","URL","window","location","new_search_params_string","URLSearchParams","Array","from","searchParams","entries","filter","key","has","value","String","sort","key_a","key_b","localeCompare","origin","pathname","history","pushState","App","React","useState","error","setError","resources","setResources","tags","setTags","latitude","setLatitude","longitude","setLongitude","Set","selectedTags","setSelectedTags","loadResources","useCallback","current_url","get","split","Boolean","search_params_data","lat","lon","console","log","isArray","join","search_params","urls","api","fetch","then","response","json","data","getLocation","navigator","geolocation","getCurrentPosition","position","new_latitude","coords","new_longitude","message","clearLocation","toggleTag","delete","add","useEffect","selected_tags","className","href","target","rel","onClick","map","resource","title","description","link","JSON","stringify","Welcome","router","createHashRouter","path","element","children","isLocalhost","hostname","env","frontend","ReactDOM","render","StrictMode","fallbackElement","document","getElementById"],"mappings":"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","file":"static/js/main.bedd803b.chunk.js","sourcesContent":["function hexToRGBArray(color) {\n  if (color.startsWith('#')) {\n    color = color.substring(1)\n  }\n\n  if (color.length === 3) {\n    color = color.charAt(0) + color.charAt(0) + color.charAt(1) + color.charAt(1) + color.charAt(2) + color.charAt(2);\n  } else if (color.length !== 6) {\n    throw (new Error('Invalid hex color: ' + color));\n  }\n\n  let rgb = [];\n  for (var i = 0; i <= 2; i++) {\n    rgb[i] = parseInt(color.substr(i * 2, 2), 16);\n  }\n\n  return rgb;\n}\nfunction luma(color) {\n  // color can be a hex string or an array of RGB values 0-255\n  const rgb = (typeof color === 'string') ? hexToRGBArray(color) : color;\n  return (0.2126 * rgb[0]) + (0.7152 * rgb[1]) + (0.0722 * rgb[2]); // SMPTE C, Rec. 709 weightings\n}\nfunction getContrastingColorFromHex(color) {\n  // source: https://stackoverflow.com/questions/635022/calculating-contrasting-colours-in-javascript\n  // exact answer: https://stackoverflow.com/a/6511606/2387277\n  // example: https://jsfiddle.net/thomasrosen/9njo6t7s/20/\n\n  return (luma(color) >= 165) ? '#000' : '#fff';\n}\n\nfunction string2color(str) {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  let color = '#';\n  for (let i = 0; i < 3; i++) {\n    let value = (hash >> (i * 8)) & 0xFF;\n    color += ('00' + value.toString(16)).substr(-2);\n  }\n  return color;\n}\n\nmodule.exports = {\n  getContrastingColorFromHex,\n  string2color,\n};\n","import React from 'react'\n\nimport {\n  getContrastingColorFromHex,\n  string2color,\n} from '../functions.js'\n\nexport default function Tag({ tag, style, ...props }) {\n  const color = string2color(tag) // TODO make sure to only run this once\n  const textColor = getContrastingColorFromHex(color) // TODO make sure to only run this once\n\n  return <button\n    {...props}\n    style={{\n      ...style,\n      backgroundColor: color,\n      color: textColor,\n    }}\n  >\n    {tag}\n  </button>\n}\n","import React from 'react'\nimport './App.css'\n\nimport '../fonts/ubuntu-v15-latin/index.css'\nimport '../fonts/ubuntu-mono-v10-latin/index.css'\n\nimport {\n  // NavLink,\n  Outlet,\n} from 'react-router-dom'\n\nimport Tag from './Tag.js'\n\nfunction pushReplaceSearchParams(new_searchParams) {\n  let url = new URL(window.location)\n\n  const new_search_params_string = new URLSearchParams(\n    [\n      ...(\n        Array.from(url.searchParams.entries())\n          .filter(([key]) => !new_searchParams.has(key))\n      ),\n      ...(\n        [...new_searchParams.entries()]\n          .filter(([, value]) => String(value).length > 0)\n      ),\n    ]\n      .sort(([key_a], [key_b]) => key_a.localeCompare(key_b)) // sort alphabetically\n  ).toString()\n\n  url = new URL(`${url.origin}${url.pathname}${new_search_params_string.length > 0 ? '?' + new_search_params_string : ''}`)\n  window.history.pushState({}, '', url)\n}\n\nexport default function App() {\n\n  const [error, setError] = React.useState(null)\n\n  const [resources, setResources] = React.useState([])\n  const [tags, setTags] = React.useState(null)\n\n  const [latitude, setLatitude] = React.useState(null)\n  const [longitude, setLongitude] = React.useState(null)\n  const [selectedTags, setSelectedTags] = React.useState(new Set())\n\n  const loadResources = React.useCallback(() => {\n\n    const current_url = new URL(window.location);\n    const latitude = (current_url.searchParams.get('lat') || '')\n    const longitude = (current_url.searchParams.get('lon') || '')\n    const tags = (current_url.searchParams.get('tags') || '').split(',').filter(Boolean)\n\n    const search_params_data = {}\n\n    if (\n      typeof latitude === 'string' && latitude.length > 0 &&\n      typeof longitude === 'string' && longitude.length > 0\n    ) {\n      search_params_data.lat = latitude\n      search_params_data.lon = longitude\n    }\n\n    console.log('tags', tags)\n    if (Array.isArray(tags) && tags.length > 0) {\n      search_params_data.tags = tags.join(',')\n    }\n\n    const search_params = new URLSearchParams(search_params_data).toString()\n\n    const url = `${window.urls.api}resources.json${search_params.length > 0 ? '?' + search_params : ''}`;\n    console.log(url);\n\n    fetch(url)\n      .then((response) => response.json())\n      .then((data) => {\n        setResources(data.resources)\n        console.log(data.resources)\n      })\n  }, [])\n\n  const getLocation = React.useCallback(() => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition((position) => {\n        setError('')\n\n        const new_latitude = position.coords.latitude\n        const new_longitude = position.coords.longitude\n        setLatitude(new_latitude)\n        setLongitude(new_longitude)\n\n        pushReplaceSearchParams(new URLSearchParams([\n          ['lat', new_latitude],\n          ['lon', new_longitude],\n        ]))\n\n        loadResources()\n      }, (error) => {\n        setError(error.message)\n      })\n    } else {\n      setError('Geolocation is not supported by this browser.')\n    }\n  }, [loadResources])\n\n  const clearLocation = React.useCallback(() => {\n    setLatitude(null)\n    setLongitude(null)\n    pushReplaceSearchParams(new URLSearchParams([\n      ['lat', ''],\n      ['lon', ''],\n    ]))\n    loadResources()\n  }, [loadResources])\n\n  const toggleTag = React.useCallback(tag => {\n\n    if (selectedTags.has(tag)) {\n      selectedTags.delete(tag)\n    } else {\n      selectedTags.add(tag)\n    }\n    setSelectedTags(new Set(selectedTags))\n\n    pushReplaceSearchParams(new URLSearchParams([\n      ['tags', [...selectedTags].filter(Boolean).join(',')],\n    ]))\n\n\n    loadResources()\n  }, [loadResources, selectedTags])\n\n  React.useEffect(() => {\n\n    const current_url = new URL(window.location);\n    const latitude = (current_url.searchParams.get('lat') || '')\n    setLatitude(latitude)\n    const longitude = (current_url.searchParams.get('lon') || '')\n    setLongitude(longitude)\n    const selected_tags = (current_url.searchParams.get('tags') || '').split(',')\n    setSelectedTags(new Set(selected_tags))\n\n    fetch(window.urls.api + 'tags.json')\n    .then((response) => response.json())\n    .then((data) => {\n      setTags(data.tags)\n    })\n\n    loadResources()\n  }, [loadResources])\n\n  return <div className=\"app_wrapper\">\n    <header>\n      <h1>Queer Resources</h1>\n      <a href=\"https://github.com/thomasrosen/queer\" target=\"_blank\" rel=\"noreferrer\">Sourcecode</a>\n    </header>\n    \n    <main>\n\n      <p>A collection of resources for queer people. You're of course also welcome to look through the information if you are an ally.</p>\n\n      <p>You can filter the links via your location and some tags.</p>\n\n      {error && <p>Error: {error}</p>}\n\n      <div className=\"tag_row\">\n        <button onClick={getLocation}>Filter for resources near you</button>\n        <button onClick={clearLocation}>Clear location filter</button>\n      </div>\n      {\n        latitude && longitude\n          ? <p>Location: {latitude} / {longitude}</p>\n          : null\n      }\n\n      <div className=\"tag_row\">\n        { tags && tags.map(tag => {\n          return <Tag\n            key={tag}\n            tag={tag}\n            data-selected={selectedTags.has(tag) ? 'true' : 'false'}\n            onClick={() => toggleTag(tag)}\n          />\n        }) }\n      </div>\n\n      {\n        resources &&\n        resources.map(resource => {\n          return <div key={JSON.stringify(resource)}>\n            <br />\n            <h3>{resource.title}</h3>\n            <p>{resource.description}</p>\n            <a href={resource.link} target=\"_blank\" rel=\"noreferrer\">{resource.link}</a>\n            <div className=\"tag_row\">\n              {\n                resource.tags.map(tag => {\n                  return <Tag\n                    key={tag}\n                    tag={tag}\n                    data-selected={selectedTags.has(tag) ? 'true' : 'false'}\n                    onClick={() => toggleTag(tag)}\n                  />\n                })\n              }\n            </div>\n          </div>\n        })\n      }\n\n      <Outlet />\n    </main>\n\n  </div>\n}\n","export default function Welcome() {\n  return <div>\n      \n  </div>\n}\n","import {\n  createHashRouter,\n} from 'react-router-dom'\n\nimport App from './App.js'\nimport Welcome from './pages/welcome.js'\n\nexport const router = createHashRouter([\n  {\n    path: '/',\n    element: <App />,\n    children: [\n      {\n        path: '/',\n        element: <Welcome />,\n      },\n      {\n        path: '*',\n        element: <Welcome />,\n      },\n    ]\n  },\n]);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\n\nimport { router } from './components/router.js';\nimport {\n  RouterProvider,\n} from 'react-router-dom'\n\n// import reportWebVitals from './reportWebVitals';\n\n// check if domain is 0.0.0.0\nconst isLocalhost = Boolean(\n  window.location.hostname === '0.0.0.0' ||\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]'\n)\n\nwindow.env = isLocalhost === true ? 'dev' : 'prod'\nwindow.urls = {\n  frontend: 'https://queer.thomasrosen.me/',\n  api: 'https://queer.thomasrosen.me/api/',\n}\nif (window.env === 'dev') {\n  window.urls.frontend = 'http://0.0.0.0:3000/'\n  window.urls.api = 'http://0.0.0.0:17215/api/'\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <RouterProvider\n      router={router}\n      fallbackElement=\"Loading…\"\n    />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n"],"sourceRoot":""}