(this.webpackJsonpqueer=this.webpackJsonpqueer||[]).push([[0],{17:function(e,t){function r(e){const t="string"===typeof e?function(e){if(e.startsWith("#")&&(e=e.substring(1)),3===e.length)e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2);else if(6!==e.length)throw new Error("Invalid hex color: "+e);let t=[];for(var r=0;r<=2;r++)t[r]=parseInt(e.substr(2*r,2),16);return t}(e):e;return.2126*t[0]+.7152*t[1]+.0722*t[2]}e.exports={getContrastingColorFromHex:function(e){return r(e)>=165?"#000":"#fff"},string2color:function(e){let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);let r="#";for(let n=0;n<3;n++){r+=("00"+(t>>8*n&255).toString(16)).substr(-2)}return r}}},18:function(e,t,r){},19:function(e,t,r){},20:function(e,t,r){},29:function(e,t,r){},38:function(e,t,r){"use strict";r.r(t);var n=r(0),s=r.n(n),a=r(9),o=r.n(a),c=(r(29),r(11)),l=(r(18),r(19),r(20),r(41)),i=r(5),u=r(2),h=r(7);function d(e){let t=new URL(window.location);const r=t.searchParams.toString(),n=new URLSearchParams([...Array.from(t.searchParams.entries()).filter(t=>{let[r]=t;return!e.has(r)}),...[...e.entries()].filter(e=>{let[,t]=e;return String(t).length>0})].sort((e,t)=>{let[r]=e,[n]=t;return r.localeCompare(n)})).toString();r!==n&&(t=new URL("".concat(t.origin).concat(t.pathname).concat(n.length>0?"?"+n:"")),window.history.pushState({},"",t))}const j=Object(h.c)({name:"filter",initialState:{tags:[],selectedTags:[],queryText:"",latitude:0,longitude:0},reducers:{setTags:(e,t)=>{e.tags=t.payload},setSelectedTags:(e,t)=>{e.selectedTags=t.payload},toggleTag:(e,t)=>{e.selectedTags.includes(t.payload)?e.selectedTags=e.selectedTags.filter(e=>e!==t.payload):e.selectedTags.push(t.payload),e.selectedTags=e.selectedTags.filter(Boolean),0===e.selectedTags.length?d(new URLSearchParams([["tags",""]])):d(new URLSearchParams([["tags",e.selectedTags.join(",")]]))},setQueryText:(e,t)=>{e.queryText=t.payload,0===e.queryText.length?d(new URLSearchParams([["q",""]])):d(new URLSearchParams([["q",e.queryText]]))},setGeoLocation:(e,t)=>{e.latitude=t.payload.latitude,e.longitude=t.payload.longitude,d(new URLSearchParams([["lat",e.latitude],["lon",e.longitude]]))},clearGeoLocation:e=>{e.latitude=null,e.longitude=null,d(new URLSearchParams([["lat",""],["lon",""]]))}}}),{setTags:b,setSelectedTags:g,toggleTag:p,setQueryText:f,setGeoLocation:O,clearGeoLocation:m}=j.actions,x=e=>e.filter.tags,w=e=>e.filter.selectedTags.filter(Boolean),y=e=>e.filter.queryText,k=e=>({latitude:e.filter.latitude,longitude:e.filter.longitude});var S=j.reducer;const v=Object(h.c)({name:"resources",initialState:{resources:[]},reducers:{setResources:(e,t)=>{e.resources=t.payload}}}),{setResources:T}=v.actions,C=Object(h.b)("resources/fetchResources",async(e,t)=>{console.log("fetchResources");const{dispatch:r,getState:n}=t||{},{filter:s}=n(),{latitude:a,longitude:o,selectedTags:c,queryText:l}=s||{},i={};null!==a&&String(a).length>0&&null!==o&&String(o).length>0&&(i.lat=a,i.lon=o);const u=c.filter(Boolean);Array.isArray(u)&&u.length>0&&(i.tags=u.join(",")),"string"===typeof l&&l.length>0&&(i.q=l);const h=new URLSearchParams(i).toString(),d="".concat(window.urls.api,"resources.json").concat(h.length>0?"?"+h:"");console.log("url",d),fetch(d).then(e=>e.json()).then(e=>{console.log("data",e),r(T(e.resources))})}),L=e=>e.resources.resources;var P=v.reducer,R=r(8),q=r(23),A=r(17),U=r(3);const _=["tag","style"];function N(e){let{tag:t,style:r}=e,n=Object(q.a)(e,_);const s=Object(A.string2color)(t),a=Object(A.getContrastingColorFromHex)(s);return Object(U.jsx)("button",Object(R.a)(Object(R.a)({},n),{},{style:Object(R.a)({backgroundColor:s,color:a},r),children:t}))}function E(e){let{onError:t=()=>{}}=e;const r=Object(i.b)(),n=Object(i.c)(x),a=Object(i.c)(w),o=Object(i.c)(y),{latitude:c,longitude:l}=Object(i.c)(k),u=Object(i.c)(L),h=s.a.useCallback(()=>{r(C())},[r]),d=s.a.useCallback(()=>{const e=new URL(window.location),t=e.searchParams.get("lat")||"",n=e.searchParams.get("lon")||"",s={};"string"===typeof t&&t.length>0&&"string"===typeof n&&n.length>0&&(s.lat=t,s.lon=n);const a=new URLSearchParams(s).toString(),o="".concat(window.urls.api,"tags.json").concat(a.length>0?"?"+a:"");fetch(o).then(e=>e.json()).then(e=>{r(b(e.tags)),h()})},[r,h]),j=s.a.useCallback(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{t(""),r(O({latitude:e.coords.latitude,longitude:e.coords.longitude})),d(),h()},e=>{t(e.message)}):t("Geolocation is not supported by this browser.")},[r,t,d,h]),S=s.a.useCallback(()=>{r(m()),d(),h()},[r,d,h]),v=s.a.useCallback(e=>{r(p(e)),h()},[r,h]),T=s.a.useCallback(e=>{e&&(r(f(e.target.value)),h())},[r,h]);return s.a.useEffect(()=>{function e(){const e=new URL(window.location),t=e.searchParams.get("lat")||"",n=e.searchParams.get("lon")||"";r(O({latitude:t,longitude:n}));const s=(e.searchParams.get("tags")||"").split(",");r(g(s));const a=e.searchParams.get("q")||"";r(f(a)),h()}return e(),window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[r,h]),s.a.useEffect(()=>{d()},[d,c,l]),Object(U.jsxs)("div",{children:[Object(U.jsx)("h2",{children:"Filter for resources in near you:"}),Object(U.jsxs)("div",{className:"tag_row",children:[Object(U.jsx)("button",{onClick:j,children:"Get my Location"}),c&&l?Object(U.jsx)("button",{onClick:S,children:"Clear Location"}):null]}),c&&l?Object(U.jsxs)("p",{children:["Your Location: ",c," / ",l]}):null,Object(U.jsx)("br",{}),Object(U.jsx)("h2",{children:"Filter by tag:"}),Object(U.jsx)("div",{className:"tag_row",children:n&&n.map(e=>Object(U.jsx)(N,{tag:e,"data-selected":a.includes(e)?"true":"false",onClick:()=>v(e)},e))}),Object(U.jsx)("br",{}),Object(U.jsx)("h2",{children:"Search:"}),Object(U.jsx)("input",{style:{margin:"20px 0"},type:"search",placeholder:"Search\u2026",defaultValue:o,onChange:T}),Object(U.jsx)("br",{}),Object(U.jsx)("br",{}),Object(U.jsx)("h2",{children:"Result Summary:"}),Object(U.jsx)("br",{}),0===u.length?Object(U.jsx)("p",{children:"No resources found."}):null,1===u.length?Object(U.jsx)("p",{children:"One resources found."}):null,u.length>1?Object(U.jsxs)("p",{children:[u.length," resources found."]}):null]})}function F(e){if(e.split("/").length<=4){const t=/.*:\/\/(?:www\.)?([^/]*).*/gm;return e.replace(t,"$1")}return e}function G(){const e=Object(i.b)(),t=Object(i.c)(L),r=Object(i.c)(w),n=s.a.useCallback(t=>{e(p(t)),e(C())},[e]),[a,o]=s.a.useState(!1),[c,h]=s.a.useState(null),d=()=>{o(e=>!e)};return Object(U.jsxs)("div",{className:"app_wrapper ".concat(!0===a?"show_filters":"hide_filters"),children:[Object(U.jsxs)("header",{children:[!0===a?Object(U.jsx)("button",{className:"hide_on_large_screens",onClick:d,children:"Close Filters"}):null,Object(U.jsx)("h1",{children:"\ud83c\udff3\ufe0f\u200d\ud83c\udf08 QR"}),Object(U.jsx)("a",{href:"https://github.com/thomasrosen/queer",target:"_blank",rel:"noreferrer",children:"Sourcecode"})]}),Object(U.jsx)("nav",{children:Object(U.jsx)(E,{onError:h})}),Object(U.jsxs)("main",{children:[Object(U.jsx)("h1",{children:"\ud83c\udff3\ufe0f\u200d\ud83c\udf08 Queer Resources"}),Object(U.jsx)("br",{}),Object(U.jsx)("p",{children:"A collection of resources for queer people. You're of course also welcome to look through the information if you are an ally."}),Object(U.jsx)("p",{children:"You can filter the links via your location and some tags."}),Object(U.jsxs)("p",{children:["The website is maintained by ",Object(U.jsx)("a",{href:"https://thomasrosen.me/",children:"Thomas Rosen"}),".",Object(U.jsx)("br",{}),"Send an email to ",Object(U.jsx)("a",{href:"mailto:queer@thomasrosen.me",children:"queer@thomasrosen.me"})," if you want to add a resource."]}),Object(U.jsxs)("p",{children:["Your privacy is important to me. The website saves no data about you. I have analytics enabled, but these are fully annonymous. Look at the source code or ask me, if you need more information.",Object(U.jsx)("br",{}),"And fyi the website is hosted at ",Object(U.jsx)("a",{href:"https://uberspace.de/",target:"_blank",rel:"noreferrer",children:"Uberspace"})," in the EU."]}),Object(U.jsxs)("div",{className:"hide_on_large_screens",children:[Object(U.jsx)("br",{}),Object(U.jsx)("button",{onClick:d,children:!0===a?"Close Filters":"Open Filters"}),Object(U.jsx)("br",{})]}),Object(U.jsx)("br",{}),Object(U.jsx)("br",{}),c&&Object(U.jsxs)("p",{children:["Error: ",c]}),t&&t.map(e=>{const t=[];let s=null;if(e.hasOwnProperty("link")&&(Array.isArray(e.link)&&e.link.length>0?(s=e.link[0],t.push(...e.link.map(e=>({url:e,title:F(e)})))):"string"===typeof e.link&&(s=e.link,t.push({url:e.link,title:F(e.link)}))),e.hasOwnProperty("contact")&&Array.isArray(e.contact)&&e.contact.length>0)for(const r of e.contact){if(r.hasOwnProperty("phone")){const e=Object(l.a)(r.phone);t.push({url:e.getURI(),title:e.formatInternational()})}r.hasOwnProperty("email")&&t.push({url:"mailto:".concat(r.email),title:r.email})}return Object(U.jsxs)("div",{children:[Object(U.jsx)("h3",{children:null!==s?Object(U.jsx)("a",{href:s,target:"_blank",rel:"noreferrer",children:e.title}):e.title}),e.description&&e.description.length>0?Object(U.jsx)("p",{children:e.description}):null,Object(U.jsx)("div",{className:"tag_row small",children:t.map(e=>{let{title:t,url:r}=e;return Object(U.jsx)("a",{href:r,className:"body2",style:{display:"block"},children:t},r)})}),Object(U.jsx)("div",{className:"tag_row small",children:e.tags.map(e=>Object(U.jsx)(N,{className:"small",tag:e,"data-selected":r.includes(e)?"true":"false",onClick:()=>n(e)},e))}),Object(U.jsx)("br",{})]},JSON.stringify(e))}),t&&0===t.length?Object(U.jsx)("p",{children:"No resources found."}):null,t?null:Object(U.jsx)("p",{children:"Loading..."}),Object(U.jsx)(u.a,{})]})]})}function I(){return Object(U.jsx)("div",{})}const B=Object(c.b)([{path:"/",element:Object(U.jsx)(G,{}),children:[{path:"/",element:Object(U.jsx)(I,{})},{path:"*",element:Object(U.jsx)(I,{})}]}]);var Q=Object(h.a)({reducer:{filter:S,resources:P}});const Y=Boolean("0.0.0.0"===window.location.hostname||"localhost"===window.location.hostname||"[::1]"===window.location.hostname);if(window.env=!0===Y?"dev":"prod",window.urls={frontend:"https://queer.thomasrosen.me/",api:"https://queer.thomasrosen.me/api/"},"dev"===window.env){const e="localhost";window.urls.frontend="http://".concat(e,":3000/"),window.urls.api="http://".concat(e,":17215/api/")}o.a.render(Object(U.jsx)(s.a.StrictMode,{children:Object(U.jsx)(i.a,{store:Q,children:Object(U.jsx)(c.a,{router:B,fallbackElement:"Loading\u2026"})})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.5a91a05e.chunk.js.map