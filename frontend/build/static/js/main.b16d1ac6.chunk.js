(this.webpackJsonpqueer=this.webpackJsonpqueer||[]).push([[0],{35:function(e,t){function n(e){var t="string"===typeof e?function(e){if(e.startsWith("#")&&(e=e.substring(1)),3===e.length)e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2);else if(6!==e.length)throw new Error("Invalid hex color: "+e);for(var t=[],n=0;n<=2;n++)t[n]=parseInt(e.substr(2*n,2),16);return t}(e):e;return.2126*t[0]+.7152*t[1]+.0722*t[2]}e.exports={getContrastingColorFromHex:function(e){return n(e)>=165?"#000":"#fff"},string2color:function(e){for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);for(var r="#",a=0;a<3;a++){r+=("00"+(t>>8*a&255).toString(16)).substr(-2)}return r}}},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},49:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(25),o=n.n(c),s=(n(49),n(26)),l=n(11),i=n(8),u=n(4),h=(n(38),n(39),n(40),n(61)),d=n(3),j=n(16),b=n(41),f=n(35),g=n(2),O=["tag","style"];function p(e){var t=e.tag,n=e.style,r=Object(b.a)(e,O),a=Object(f.string2color)(t),c=Object(f.getContrastingColorFromHex)(a);return Object(g.jsx)("button",Object(j.a)(Object(j.a)({},r),{},{style:Object(j.a)({backgroundColor:a,color:c},n),children:t}))}var m=n(10),x=n(15);function w(e){var t=new URL(window.location),n=t.searchParams.toString(),r=new URLSearchParams([].concat(Object(i.a)(Array.from(t.searchParams.entries()).filter((function(t){var n=Object(u.a)(t,1)[0];return!e.has(n)}))),Object(i.a)(Object(i.a)(e.entries()).filter((function(e){var t=Object(u.a)(e,2)[1];return String(t).length>0})))).sort((function(e,t){var n=Object(u.a)(e,1)[0],r=Object(u.a)(t,1)[0];return n.localeCompare(r)}))).toString();n!==r&&(t=new URL("".concat(t.origin).concat(t.pathname).concat(r.length>0?"?"+r:"")),window.history.pushState({},"",t))}var y=Object(x.c)({name:"filter",initialState:{tags:[],selectedTags:[],queryText:"",latitude:0,longitude:0},reducers:{setTags:function(e,t){e.tags=t.payload},setSelectedTags:function(e,t){e.selectedTags=t.payload},toggleTag:function(e,t){e.selectedTags.includes(t.payload)?e.selectedTags=e.selectedTags.filter((function(e){return e!==t.payload})):e.selectedTags.push(t.payload),e.selectedTags=e.selectedTags.filter(Boolean),0===e.selectedTags.length?w(new URLSearchParams([["tags",""]])):w(new URLSearchParams([["tags",e.selectedTags.join(",")]]))},setQueryText:function(e,t){e.queryText=t.payload,0===e.queryText.length?w(new URLSearchParams([["q",""]])):w(new URLSearchParams([["q",e.queryText]]))},setGeoLocation:function(e,t){e.latitude=t.payload.latitude,e.longitude=t.payload.longitude,w(new URLSearchParams([["lat",e.latitude],["lon",e.longitude]]))},clearGeoLocation:function(e){e.latitude=null,e.longitude=null,w(new URLSearchParams([["lat",""],["lon",""]]))}}}),v=y.actions,k=v.setTags,S=v.setSelectedTags,T=v.toggleTag,C=v.setQueryText,L=v.setGeoLocation,P=v.clearGeoLocation,R=function(e){return e.filter.tags},q=function(e){return e.filter.selectedTags.filter(Boolean)},A=function(e){return e.filter.queryText},U=function(e){return{latitude:e.filter.latitude,longitude:e.filter.longitude}},_=y.reducer,N=n(5),E=n(9),F=Object(x.c)({name:"resources",initialState:{resources:[]},reducers:{setResources:function(e,t){e.resources=t.payload}}}),G=F.actions.setResources,I=Object(x.b)("resources/fetchResources",function(){var e=Object(E.a)(Object(N.a)().mark((function e(t,n){var r,a,c,o,s,l,i,u,h,d,j,b,f,g;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("fetchResources"),a=(r=n||{}).dispatch,c=r.getState,o=c(),s=o.filter,i=(l=s||{}).latitude,u=l.longitude,h=l.selectedTags,d=l.queryText,j={},null!==i&&String(i).length>0&&null!==u&&String(u).length>0&&(j.lat=i,j.lon=u),b=h.filter(Boolean),Array.isArray(b)&&b.length>0&&(j.tags=b.join(",")),"string"===typeof d&&d.length>0&&(j.q=d),f=new URLSearchParams(j).toString(),g="".concat(window.urls.api,"resources.json").concat(f.length>0?"?"+f:""),console.log("url",g),fetch(g).then((function(e){return e.json()})).then((function(e){console.log("data",e),a(G(e.resources))}));case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),B=function(e){return e.resources.resources},Q=F.reducer;function Y(e){var t=e.onError,n=void 0===t?function(){}:t,r=Object(m.b)(),c=Object(m.c)(R),o=Object(m.c)(q),s=Object(m.c)(A),l=Object(m.c)(U),i=l.latitude,u=l.longitude,h=Object(m.c)(B),d=a.a.useCallback((function(){r(I())}),[r]),j=a.a.useCallback((function(){var e=new URL(window.location),t=e.searchParams.get("lat")||"",n=e.searchParams.get("lon")||"",a={};"string"===typeof t&&t.length>0&&"string"===typeof n&&n.length>0&&(a.lat=t,a.lon=n);var c=new URLSearchParams(a).toString(),o="".concat(window.urls.api,"tags.json").concat(c.length>0?"?"+c:"");fetch(o).then((function(e){return e.json()})).then((function(e){r(k(e.tags)),d()}))}),[r,d]),b=a.a.useCallback((function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){n(""),r(L({latitude:e.coords.latitude,longitude:e.coords.longitude})),j(),d()}),(function(e){n(e.message)})):n("Geolocation is not supported by this browser.")}),[r,n,j,d]),f=a.a.useCallback((function(){r(P()),j(),d()}),[r,j,d]),O=a.a.useCallback((function(e){r(T(e)),d()}),[r,d]),x=a.a.useCallback((function(e){e&&(r(C(e.target.value)),d())}),[r,d]);return a.a.useEffect((function(){function e(){var e=new URL(window.location),t=e.searchParams.get("lat")||"",n=e.searchParams.get("lon")||"";r(L({latitude:t,longitude:n}));var a=(e.searchParams.get("tags")||"").split(",");r(S(a));var c=e.searchParams.get("q")||"";r(C(c)),d()}return e(),window.addEventListener("popstate",e),function(){window.removeEventListener("popstate",e)}}),[r,d]),a.a.useEffect((function(){j()}),[j,i,u]),Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:"Filter for resources in near you:"}),Object(g.jsxs)("div",{className:"tag_row",children:[Object(g.jsx)("button",{onClick:b,children:"Get my Location"}),i&&u?Object(g.jsx)("button",{onClick:f,children:"Clear Location"}):null]}),i&&u?Object(g.jsxs)("p",{children:["Your Location: ",i," / ",u]}):null,Object(g.jsx)("br",{}),Object(g.jsx)("h2",{children:"Filter by tag:"}),Object(g.jsx)("div",{className:"tag_row",children:c&&c.map((function(e){return Object(g.jsx)(p,{tag:e,"data-selected":o.includes(e)?"true":"false",onClick:function(){return O(e)}},e)}))}),Object(g.jsx)("br",{}),Object(g.jsx)("h2",{children:"Search:"}),Object(g.jsx)("input",{style:{margin:"20px 0"},type:"search",placeholder:"Search\u2026",defaultValue:s,onChange:x}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),Object(g.jsx)("h2",{children:"Result Summary:"}),Object(g.jsx)("br",{}),0===h.length?Object(g.jsx)("p",{children:"No resources found."}):null,1===h.length?Object(g.jsx)("p",{children:"One resources found."}):null,h.length>1?Object(g.jsxs)("p",{children:[h.length," resources found."]}):null]})}function J(e){if(e.split("/").length<=4){return e.replace(/.*:\/\/(?:www\.)?([^/]*).*/gm,"$1")}return e}function H(){var e=Object(m.b)(),t=Object(m.c)(B),n=Object(m.c)(q),r=a.a.useCallback((function(t){e(T(t)),e(I())}),[e]),c=a.a.useState(!1),o=Object(u.a)(c,2),s=o[0],j=o[1],b=a.a.useState(null),f=Object(u.a)(b,2),O=f[0],x=f[1],w=function(){j((function(e){return!e}))};return Object(g.jsxs)("div",{className:"app_wrapper ".concat(!0===s?"show_filters":"hide_filters"),children:[Object(g.jsxs)("header",{children:[!0===s?Object(g.jsx)("button",{className:"hide_on_large_screens",onClick:w,children:"Close Filters"}):null,Object(g.jsx)("h1",{children:"\ud83c\udff3\ufe0f\u200d\ud83c\udf08 QR"}),Object(g.jsx)("a",{href:"https://github.com/thomasrosen/queer",target:"_blank",rel:"noreferrer",children:"Sourcecode"})]}),Object(g.jsx)("nav",{children:Object(g.jsx)(Y,{onError:x})}),Object(g.jsxs)("main",{children:[Object(g.jsx)("h1",{children:"\ud83c\udff3\ufe0f\u200d\ud83c\udf08 Queer Resources"}),Object(g.jsx)("br",{}),Object(g.jsx)("p",{children:"A collection of resources for queer people. You're of course also welcome to look through the information if you are an ally."}),Object(g.jsx)("p",{children:"You can filter the links via your location and some tags."}),Object(g.jsxs)("p",{children:["The website is maintained by ",Object(g.jsx)("a",{href:"https://thomasrosen.me/",children:"Thomas Rosen"}),".",Object(g.jsx)("br",{}),"Send an email to ",Object(g.jsx)("a",{href:"mailto:queer@thomasrosen.me",children:"queer@thomasrosen.me"})," if you want to add a resource."]}),Object(g.jsxs)("p",{children:["Your privacy is important to me. The website saves no data about you. I have analytics enabled, but these are fully annonymous. Look at the source code or ask me, if you need more information.",Object(g.jsx)("br",{}),"And fyi the website is hosted at ",Object(g.jsx)("a",{href:"https://uberspace.de/",target:"_blank",rel:"noreferrer",children:"Uberspace"})," in the EU."]}),Object(g.jsxs)("div",{className:"hide_on_large_screens",children:[Object(g.jsx)("br",{}),Object(g.jsx)("button",{onClick:w,children:!0===s?"Close Filters":"Open Filters"}),Object(g.jsx)("br",{})]}),Object(g.jsx)("br",{}),Object(g.jsx)("br",{}),O&&Object(g.jsxs)("p",{children:["Error: ",O]}),t&&t.map((function(e){var t=[],a=null;if(e.hasOwnProperty("link")&&(Array.isArray(e.link)&&e.link.length>0?(a=e.link[0],t.push.apply(t,Object(i.a)(e.link.map((function(e){return{url:e,title:J(e)}}))))):"string"===typeof e.link&&(a=e.link,t.push({url:e.link,title:J(e.link)}))),e.hasOwnProperty("contact")&&Array.isArray(e.contact)&&e.contact.length>0){var c,o=Object(l.a)(e.contact);try{for(o.s();!(c=o.n()).done;){var s=c.value;if(s.hasOwnProperty("phone")){var u=Object(h.a)(s.phone);t.push({url:u.getURI(),title:u.formatInternational()})}s.hasOwnProperty("email")&&t.push({url:"mailto:".concat(s.email),title:s.email})}}catch(d){o.e(d)}finally{o.f()}}return Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:null!==a?Object(g.jsx)("a",{href:a,target:"_blank",rel:"noreferrer",children:e.title}):e.title}),e.description&&e.description.length>0?Object(g.jsx)("p",{children:e.description}):null,Object(g.jsx)("div",{className:"tag_row small",children:t.map((function(e){var t=e.title,n=e.url;return Object(g.jsx)("a",{href:n,children:Object(g.jsx)(p,{className:"small",tag:t,style:{cursor:"pointer"},"data-selected":"false"})},n)}))}),Object(g.jsx)("div",{className:"tag_row small",children:e.tags.map((function(e){return Object(g.jsx)(p,{className:"small",tag:e,"data-selected":n.includes(e)?"true":"false",onClick:function(){return r(e)}},e)}))}),Object(g.jsx)("br",{})]},JSON.stringify(e))})),t&&0===t.length?Object(g.jsx)("p",{children:"No resources found."}):null,t?null:Object(g.jsx)("p",{children:"Loading..."}),Object(g.jsx)(d.a,{})]})]})}function M(){return Object(g.jsx)("div",{})}var V=Object(s.a)([{path:"/",element:Object(g.jsx)(H,{}),children:[{path:"/",element:Object(g.jsx)(M,{})},{path:"*",element:Object(g.jsx)(M,{})}]}]),W=Object(x.a)({reducer:{filter:_,resources:Q}}),$=Boolean("0.0.0.0"===window.location.hostname||"localhost"===window.location.hostname||"[::1]"===window.location.hostname);if(window.env=!0===$?"dev":"prod",window.urls={frontend:"https://queer.thomasrosen.me/",api:"https://queer.thomasrosen.me/api/"},"dev"===window.env){var z="localhost";window.urls.frontend="http://".concat(z,":3000/"),window.urls.api="http://".concat(z,":17215/api/")}o.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(m.a,{store:W,children:Object(g.jsx)(d.c,{router:V,fallbackElement:"Loading\u2026"})})}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.b16d1ac6.chunk.js.map