(this.webpackJsonpqueer=this.webpackJsonpqueer||[]).push([[0],{25:function(e,t){function n(e){var t="string"===typeof e?function(e){if(e.startsWith("#")&&(e=e.substring(1)),3===e.length)e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2);else if(6!==e.length)throw new Error("Invalid hex color: "+e);for(var t=[],n=0;n<=2;n++)t[n]=parseInt(e.substr(2*n,2),16);return t}(e):e;return.2126*t[0]+.7152*t[1]+.0722*t[2]}e.exports={getContrastingColorFromHex:function(e){return n(e)>=165?"#000":"#fff"},string2color:function(e){for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);for(var r="#",a=0;a<3;a++){r+=("00"+(t>>8*a&255).toString(16)).substr(-2)}return r}}},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(26),c=n.n(o),s=(n(32),n(18)),i=n(3),l=n(6),u=(n(33),n(34),n(35),n(2)),h=n(17),j=n(27),b=n(25),f=n(4),d=["tag","style"];function g(e){var t=e.tag,n=e.style,r=Object(j.a)(e,d),a=Object(b.string2color)(t),o=Object(b.getContrastingColorFromHex)(a);return Object(f.jsx)("button",Object(h.a)(Object(h.a)({},r),{},{style:Object(h.a)(Object(h.a)({},n),{},{backgroundColor:a,color:o}),children:t}))}function O(e){var t=new URL(window.location),n=new URLSearchParams([].concat(Object(l.a)(Array.from(t.searchParams.entries()).filter((function(t){var n=Object(i.a)(t,1)[0];return!e.has(n)}))),Object(l.a)(Object(l.a)(e.entries()).filter((function(e){var t=Object(i.a)(e,2)[1];return String(t).length>0})))).sort((function(e,t){var n=Object(i.a)(e,1)[0],r=Object(i.a)(t,1)[0];return n.localeCompare(r)}))).toString();t=new URL("".concat(t.origin).concat(t.pathname).concat(n.length>0?"?"+n:"")),window.history.pushState({},"",t)}function w(){var e=a.a.useState(null),t=Object(i.a)(e,2),n=t[0],r=t[1],o=a.a.useState([]),c=Object(i.a)(o,2),s=c[0],h=c[1],j=a.a.useState(null),b=Object(i.a)(j,2),d=b[0],w=b[1],m=a.a.useState(null),p=Object(i.a)(m,2),x=p[0],v=p[1],S=a.a.useState(null),k=Object(i.a)(S,2),y=k[0],C=k[1],P=a.a.useState(new Set),A=Object(i.a)(P,2),L=A[0],R=A[1],U=a.a.useCallback((function(){var e=new URL(window.location),t=e.searchParams.get("lat")||"",n=e.searchParams.get("lon")||"",r=(e.searchParams.get("tags")||"").split(",").filter(Boolean),a={};"string"===typeof t&&t.length>0&&"string"===typeof n&&n.length>0&&(a.lat=t,a.lon=n),console.log("tags",r),Array.isArray(r)&&r.length>0&&(a.tags=r.join(","));var o=new URLSearchParams(a).toString(),c="".concat(window.urls.api,"resources.json").concat(o.length>0?"?"+o:"");console.log(c),fetch(c).then((function(e){return e.json()})).then((function(e){h(e.resources),console.log(e.resources)}))}),[]),q=a.a.useCallback((function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){r("");var t=e.coords.latitude,n=e.coords.longitude;v(t),C(n),O(new URLSearchParams([["lat",t],["lon",n]])),U()}),(function(e){r(e.message)})):r("Geolocation is not supported by this browser.")}),[U]),N=a.a.useCallback((function(){v(null),C(null),O(new URLSearchParams([["lat",""],["lon",""]])),U()}),[U]),_=a.a.useCallback((function(e){L.has(e)?L.delete(e):L.add(e),R(new Set(L)),O(new URLSearchParams([["tags",Object(l.a)(L).filter(Boolean).join(",")]])),U()}),[U,L]);return a.a.useEffect((function(){var e=new URL(window.location),t=e.searchParams.get("lat")||"";v(t);var n=e.searchParams.get("lon")||"";C(n);var r=(e.searchParams.get("tags")||"").split(",");R(new Set(r)),fetch(window.urls.api+"tags.json").then((function(e){return e.json()})).then((function(e){w(e.tags)})),U()}),[U]),Object(f.jsxs)("div",{className:"app_wrapper",children:[Object(f.jsxs)("header",{children:[Object(f.jsx)("h1",{children:"Queer Resources"}),Object(f.jsx)("a",{href:"https://github.com/thomasrosen/queer",target:"_blank",rel:"noreferrer",children:"Sourcecode"})]}),Object(f.jsxs)("main",{children:[Object(f.jsx)("p",{children:"A collection of resources for queer people. You're of course also welcome to look through the information if you are an ally."}),Object(f.jsx)("p",{children:"You can filter the links via your location and some tags."}),n&&Object(f.jsxs)("p",{children:["Error: ",n]}),Object(f.jsxs)("div",{className:"tag_row",children:[Object(f.jsx)("button",{onClick:q,children:"Filter for resources near you"}),Object(f.jsx)("button",{onClick:N,children:"Clear location filter"})]}),x&&y?Object(f.jsxs)("p",{children:["Location: ",x," / ",y]}):null,Object(f.jsx)("div",{className:"tag_row",children:d&&d.map((function(e){return Object(f.jsx)(g,{tag:e,"data-selected":L.has(e)?"true":"false",onClick:function(){return _(e)}},e)}))}),s&&s.map((function(e){return Object(f.jsxs)("div",{children:[Object(f.jsx)("br",{}),Object(f.jsx)("h3",{children:Object(f.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:e.title})}),Object(f.jsx)("p",{children:e.description}),Object(f.jsx)("div",{className:"tag_row small",children:e.tags.map((function(e){return Object(f.jsx)(g,{className:"small",tag:e,onClick:function(){return _(e)}},e)}))})]},JSON.stringify(e))})),Object(f.jsx)(u.a,{})]})]})}function m(){return Object(f.jsx)("div",{})}var p=Object(s.a)([{path:"/",element:Object(f.jsx)(w,{}),children:[{path:"/",element:Object(f.jsx)(m,{})},{path:"*",element:Object(f.jsx)(m,{})}]}]),x=Boolean("0.0.0.0"===window.location.hostname||"localhost"===window.location.hostname||"[::1]"===window.location.hostname);window.env=!0===x?"dev":"prod",window.urls={frontend:"https://queer.thomasrosen.me/",api:"https://queer.thomasrosen.me/api/"},"dev"===window.env&&(window.urls.frontend="http://0.0.0.0:3000/",window.urls.api="http://0.0.0.0:17215/api/"),c.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(u.c,{router:p,fallbackElement:"Loading\u2026"})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.4313bd21.chunk.js.map