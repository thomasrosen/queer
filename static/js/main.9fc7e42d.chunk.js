(this.webpackJsonpqueer=this.webpackJsonpqueer||[]).push([[0],{25:function(t,e){function n(t){var e="string"===typeof t?function(t){if(t.startsWith("#")&&(t=t.substring(1)),3===t.length)t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2);else if(6!==t.length)throw new Error("Invalid hex color: "+t);for(var e=[],n=0;n<=2;n++)e[n]=parseInt(t.substr(2*n,2),16);return e}(t):t;return.2126*e[0]+.7152*e[1]+.0722*e[2]}t.exports={getContrastingColorFromHex:function(t){return n(t)>=165?"#000":"#fff"},string2color:function(t){for(var e=0,n=0;n<t.length;n++)e=t.charCodeAt(n)+((e<<5)-e);for(var r="#",a=0;a<3;a++){r+=("00"+(e>>8*a&255).toString(16)).substr(-2)}return r}}},32:function(t,e,n){},33:function(t,e,n){},34:function(t,e,n){},35:function(t,e,n){},37:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),o=n(26),c=n.n(o),s=(n(32),n(18)),i=n(3),l=n(6),u=(n(33),n(34),n(35),n(2)),h=n(17),j=n(27),f=n(25),b=n(4),d=["tag","style"];function g(t){var e=t.tag,n=t.style,r=Object(j.a)(t,d),a=Object(f.string2color)(e),o=Object(f.getContrastingColorFromHex)(a);return Object(b.jsx)("button",Object(h.a)(Object(h.a)({},r),{},{style:Object(h.a)(Object(h.a)({},n),{},{backgroundColor:a,color:o}),children:e}))}function p(t){var e=new URL(window.location),n=new URLSearchParams([].concat(Object(l.a)(Array.from(e.searchParams.entries()).filter((function(e){var n=Object(i.a)(e,1)[0];return!t.has(n)}))),Object(l.a)(Object(l.a)(t.entries()).filter((function(t){var e=Object(i.a)(t,2)[1];return String(e).length>0})))).sort((function(t,e){var n=Object(i.a)(t,1)[0],r=Object(i.a)(e,1)[0];return n.localeCompare(r)}))).toString();e=new URL("".concat(e.origin).concat(e.pathname).concat(n.length>0?"?"+n:"")),window.history.pushState({},"",e)}function O(){var t=a.a.useState(null),e=Object(i.a)(t,2),n=e[0],r=e[1],o=a.a.useState([]),c=Object(i.a)(o,2),s=c[0],h=c[1],j=a.a.useState(null),f=Object(i.a)(j,2),d=f[0],O=f[1],w=a.a.useState(null),m=Object(i.a)(w,2),x=m[0],v=m[1],S=a.a.useState(null),y=Object(i.a)(S,2),C=y[0],k=y[1],P=a.a.useState(new Set),L=Object(i.a)(P,2),A=L[0],R=L[1],U=a.a.useCallback((function(){var t=new URL(window.location),e=t.searchParams.get("lat")||"",n=t.searchParams.get("lon")||"",r=(t.searchParams.get("tags")||"").split(",").filter(Boolean),a={};"string"===typeof e&&e.length>0&&"string"===typeof n&&n.length>0&&(a.lat=e,a.lon=n),console.log("tags",r),Array.isArray(r)&&r.length>0&&(a.tags=r.join(","));var o=new URLSearchParams(a).toString(),c="".concat(window.urls.api,"resources.json").concat(o.length>0?"?"+o:"");console.log(c),fetch(c).then((function(t){return t.json()})).then((function(t){h(t.resources),console.log(t.resources)}))}),[]),E=a.a.useCallback((function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){r("");var e=t.coords.latitude,n=t.coords.longitude;v(e),k(n),p(new URLSearchParams([["lat",e],["lon",n]])),U()}),(function(t){r(t.message)})):r("Geolocation is not supported by this browser.")}),[U]),q=a.a.useCallback((function(){v(null),k(null),p(new URLSearchParams([["lat",""],["lon",""]])),U()}),[U]),B=a.a.useCallback((function(t){A.has(t)?A.delete(t):A.add(t),R(new Set(A)),p(new URLSearchParams([["tags",Object(l.a)(A).filter(Boolean).join(",")]])),U()}),[U,A]);return a.a.useEffect((function(){var t=new URL(window.location),e=t.searchParams.get("lat")||"";v(e);var n=t.searchParams.get("lon")||"";k(n);var r=(t.searchParams.get("tags")||"").split(",");R(new Set(r)),fetch(window.urls.api+"tags.json").then((function(t){return t.json()})).then((function(t){O(t.tags)})),U()}),[U]),Object(b.jsxs)("div",{className:"app_wrapper",children:[Object(b.jsx)("header",{children:Object(b.jsx)("h1",{children:"Queer Resources"})}),Object(b.jsxs)("main",{children:[n&&Object(b.jsxs)("p",{children:["Error: ",n]}),Object(b.jsx)("button",{onClick:E,children:"Filter for resources near you"}),Object(b.jsx)("button",{onClick:q,children:"Clear location filter"}),x&&C?Object(b.jsxs)("p",{children:["Location: ",x," / ",C]}):null,Object(b.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",margin:"1rem 0"},children:d&&d.map((function(t){return Object(b.jsx)(g,{tag:t,"data-selected":A.has(t)?"true":"false",onClick:function(){return B(t)}},t)}))},A),s&&s.map((function(t){return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:t.title}),Object(b.jsx)("p",{children:t.description}),Object(b.jsx)("a",{href:t.link,target:"_blank",rel:"noreferrer",children:t.link}),Object(b.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",margin:"1rem 0"},children:t.tags.map((function(t){return Object(b.jsx)(g,{tag:t,"data-selected":A.has(t)?"true":"false",onClick:function(){return B(t)}},t)}))})]},JSON.stringify(t))})),Object(b.jsx)(u.a,{})]})]})}function w(){return Object(b.jsx)("div",{})}var m=Object(s.a)([{path:"/",element:Object(b.jsx)(O,{}),children:[{path:"/",element:Object(b.jsx)(w,{})},{path:"*",element:Object(b.jsx)(w,{})}]}]);window.env="dev",window.urls={frontend:"https://queer.thomasrosen.me/",api:"https://queer.thomasrosen.me/api/"},"dev"===window.env&&(window.urls.frontend="http://localhost:3000/",window.urls.api="http://localhost:1337/api/"),c.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(u.c,{router:m,fallbackElement:"Loading\u2026"})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.9fc7e42d.chunk.js.map